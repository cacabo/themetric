<head>
  <% title 'Youth Journal | Articles' %>
  <% description "List of all articles." %>
  <% keywords "articles,youth,journal" %>
</head>

<div class="container serif marg-top-2 marg-bot-2">
  <div class="row">
    <div class="col-12 col-md-10 offset-md-1 col-lg-6 offset-lg-3">
      <div class="space"></div>

      <% if params[:tag] %>
      <h2 class="title sans">Listing articles tagged with "<%=params[:tag]%>"</h2>
    <% else %>
      <h2 class="title sans">Listing all articles</h2>
      <% end %>

      <% if current_admin %>
      <%= link_to new_article_path do %>
      <button class="btn btn-outline-primary btn-sm btn-right">New article</button>
      <% end %>
      <% end %>

      <% @articles.order(created_at: :desc).each do |article| %>
      <div class="line"></div>
      <% if not article.image.nil? and not article.image_file_name.nil? %>
      <%= image_tag article.image.url(:medium), class: 'img-fluid pad-bot-25' %>
      <% end %>
      <h3 class="sans inline"><%= link_to article.title, article %></h3>
      <div class="empty-spacer"></div>
      <p class="bigger">
        <% if article.text %>
        <% if article.text.length > 100 %>
        <%= article.text.gsub(/\[.*?\]/, "")[0...100] + '...' %>
        <%= link_to article do %>
        <i class="time">click to read the full post.</i>
        <% end %>
      <% else %>
        <%= article.text.gsub(/\[.*?\]/, "") %>
        <% end %>
        <% end %>
      </p>
      <div class="empty-spacer"></div>
      <% if article.tag_list %>
      <p class="inline">
        <% article.tag_list.each do |t| %>
        <%= link_to tag_path(t) do %>
        <button class="btn btn-outline-primary btn-sm tag"><%= t %></button>
        <% end %>
        <% end %>
      </p>
      <p class="time sans inline float-right"><%= time_ago_in_words(article.created_at) %>
        ago</p>
      <% end %>
      <% end %>
      <div class="line marg-bot-0"></div>

      <div class="space"></div>
      <div class="space"></div>

      <% if params[:tag] %>
      <%= link_to articles_path do %>
      <button class="btn btn-outline-primary">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        &nbsp;Back to all articles
      </button>
      <% end %>
    <% else %>
      <%= link_to root_path do %>
      <button class="btn btn-outline-primary">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        &nbsp;Back to home</button>
      <% end %>
      <% end %>
    </div>
  </div>
</div>
